DROP TABLE RESERVA1;
DROP TABLE CLIENTE;
DROP TABLE EMPLEADO1;
DROP TABLE REGISTRO_EMPLEADOS;
DROP TABLE SUMINISTRA1;
DROP TABLE VENDE1;
DROP TABLE ARTICULO;
DROP TABLE PROVEEDOR1;
DROP TABLE HOTEL1;

CREATE TABLE HOTEL1(
    cod_hotel INT NOT NULL,
    nombre VARCHAR(20),
    n_hab_dobles INT NOT NULL, 
    n_hab_sencillas INT NOT NULL,
    ciudad VARCHAR(20),
    provincia VARCHAR(20) NOT NULL,
    cod_empleado INT
);

CREATE TABLE REGISTRO_EMPLEADOS(
    cod_empleado INT NOT NULL,
    cod_hotel INT NOT NULL,
    fecha_inicio DATE NOT NULL,
    fecha_fin DATE NOT NULL
);

CREATE TABLE CLIENTE(
    cod_cliente INT NOT NULL,
    dni INT,
    nombre VARCHAR(20),
    telefono INT
);

CREATE TABLE ARTICULO(
    cod_articulo INT NOT NULL,
    nombre VARCHAR(20),
    tipo VARCHAR(20) NOT NULL
);

CREATE TABLE PROVEEDOR1(
    cod_proveedor INT NOT NULL,
    nombre VARCHAR(20),
    ciudad VARCHAR(20) NOT NULL
);

CREATE TABLE VENDE1(
    cod_articulo INT NOT NULL,
    cod_proveedor INT NOT NULL
);

CREATE TABLE SUMINISTRA1(
    cod_articulo INT NOT NULL,
    cod_proveedor INT NOT NULL,
    cod_hotel INT NOT NULL,
    fecha_pedido DATE NOT NULL,
    cantidad INT NOT NULL,
    precio FLOAT(10) NOT NULL
);

CREATE TABLE RESERVA1(
    cod_hotel INT NOT NULL,
    cod_cliente INT NOT NULL,
    fecha_inicio DATE NOT NULL,
    fecha_fin DATE NOT NULL,
    habitacion VARCHAR(10) NOT NULL,
    precio FLOAT(10) NOT NULL
);

CREATE TABLE EMPLEADO1(
    cod_empleado INT NOT NULL,
    dni INT NOT NULL,
    nombre VARCHAR(20) NOT NULL,
    direccion VARCHAR(30),
    telefono INT,
    salario FLOAT(10) NOT NULL,
    fecha_contrato DATE NOT NULL,
    fecha_inicio DATE NOT NULL,
    cod_hotel INT NOT NULL
);

GRANT SELECT, INSERT, DELETE, UPDATE ON ARTICULO TO calabaza2, calabaza3, calabaza4;
GRANT SELECT, INSERT, DELETE, UPDATE ON VENDE1 TO calabaza2, calabaza3, calabaza4;
GRANT SELECT, INSERT, DELETE, UPDATE ON CLIENTE TO calabaza2, calabaza3, calabaza4;
GRANT SELECT, INSERT, DELETE, UPDATE ON REGISTRO_EMPLEADOS TO calabaza2, calabaza3, calabaza4;
GRANT SELECT, INSERT, DELETE, UPDATE ON EMPLEADO1 TO calabaza2, calabaza3, calabaza4;
GRANT SELECT, INSERT, DELETE, UPDATE ON HOTEL1 TO calabaza2, calabaza3, calabaza4;
GRANT SELECT, INSERT, DELETE, UPDATE ON PROVEEDOR1 TO calabaza2, calabaza3, calabaza4;
GRANT SELECT, INSERT, DELETE, UPDATE ON RESERVA1 TO calabaza2, calabaza3, calabaza4;
GRANT SELECT, INSERT, DELETE, UPDATE ON SUMINISTRA1 TO calabaza2, calabaza3, calabaza4;

DROP VIEW EmpleadoView;
DROP VIEW RegistroView;
DROP VIEW ArticuloView;
DROP VIEW VendeView;
DROP VIEW ClienteView;
DROP VIEW HotelView;
DROP VIEW SuministraView;
DROP VIEW ProveedorView;
DROP VIEW ReservaView;

CREATE VIEW EmpleadoView AS
SELECT * FROM EMPLEADO1
UNION
SELECT * FROM calabaza2.EMPLEADO2
UNION
SELECT * FROM calabaza3.EMPLEADO3
UNION
SELECT * FROM calabaza4.EMPLEADO4;

CREATE VIEW RegistroView AS 
SELECT * FROM REGISTRO_EMPLEADOS;

CREATE VIEW ArticuloView AS
SELECT * FROM ARTICULO;

CREATE VIEW VendeView AS
SELECT * FROM VENDE1
UNION
SELECT * FROM calabaza2.VENDE2;

CREATE VIEW ClienteView AS
SELECT * FROM CLIENTE;

CREATE VIEW HotelView AS
SELECT * FROM HOTEL1
UNION
SELECT * FROM calabaza2.HOTEL2
UNION
SELECT * FROM calabaza3.HOTEL3
UNION
SELECT * FROM calabaza4.HOTEL4;

CREATE VIEW SuministraView AS
SELECT * FROM SUMINISTRA1
UNION
SELECT * FROM calabaza2.SUMINISTRA2
UNION
SELECT * FROM calabaza3.SUMINISTRA3
UNION
SELECT * FROM calabaza4.SUMINISTRA4;

CREATE VIEW ProveedorView AS
SELECT * FROM PROVEEDOR1
UNION
SELECT * FROM calabaza2.PROVEEDOR2;

CREATE VIEW ReservaView AS
SELECT * FROM RESERVA1
UNION
SELECT * FROM calabaza2.RESERVA2
UNION
SELECT * FROM calabaza3.RESERVA3
UNION
SELECT * FROM calabaza4.RESERVA4;

INSERT INTO ARTICULO VALUES (1, 'Pollo', 'A'); 
INSERT INTO ARTICULO VALUES (2, 'Pavo', 'A'); 
INSERT INTO ARTICULO VALUES (3, 'Ternera', 'A'); 
INSERT INTO ARTICULO VALUES (4, 'Cordero', 'A'); 
INSERT INTO ARTICULO VALUES (5, 'Cerdo', 'A'); 
INSERT INTO ARTICULO VALUES (6, 'Verdura', 'B'); 
INSERT INTO ARTICULO VALUES (7, 'Fruta', 'B'); 
INSERT INTO ARTICULO VALUES (8, 'Legumbre', 'B'); 
INSERT INTO ARTICULO VALUES (9, 'Leche', 'C'); 
INSERT INTO ARTICULO VALUES (10, 'Queso', 'C'); 
INSERT INTO ARTICULO VALUES (11, 'Mantequilla', 'C'); 
INSERT INTO ARTICULO VALUES (12, 'Bacalao', 'D'); 
INSERT INTO ARTICULO VALUES (13, 'Pulpo', 'D');
INSERT INTO ARTICULO VALUES (14, 'Pescadilla', 'D');
INSERT INTO ARTICULO VALUES (15, 'Calamar', 'D');

INSERT INTO HOTEL1 VALUES(5, 'Santo Reino', 15, 5, 'Jaén', 'Jaén', 5);
INSERT INTO HOTEL1 VALUES(6, 'Alhambra', 6, 0, 'Granada', 'Granada', 6);
INSERT INTO HOTEL1 VALUES(9, 'Santa Paula', 30, 10, 'Granada', 'Granada', 9);

INSERT INTO EMPLEADO1
VALUES(5, 55555555, 'Susana', 'Mayor 5, Jaén', 555555, 1800, TO_DATE('01-OCT-2003', 'DD-MON-YYYY'), TO_DATE('14-JUN-2013', 'DD-MON-YYYY'), 5);

INSERT INTO EMPLEADO1
VALUES(6, 66666666, 'Gonzalo', 'Ronda 31, Granada', 666666, 1800, TO_DATE('01-ENE-1992', 'DD-MON-YYYY'), TO_DATE('17-MAR-2009', 'DD-MON-YYYY'), 6);

INSERT INTO EMPLEADO1
VALUES(9, 99999999, 'Alberto', 'Elvira 15, Granada', 999999, 1500, TO_DATE('05-SEP-2005', 'DD-MON-YYYY'), TO_DATE('05-SEP-2005', 'DD-MON-YYYY'), 9);

INSERT INTO EMPLEADO1
VALUES(13, 13131313, 'Patricia', 'Rosario 50, Jaén', 131313, 1500, TO_DATE('04-DIC-2004', 'DD-MON-YYYY'), TO_DATE('04-DIC-2004', 'DD-MON-YYYY'), 5);

INSERT INTO EMPLEADO1
VALUES(14, 14141414, 'Inés', 'Constitución 4, Granada', 141414, 1500, TO_DATE('07-MAR-2003', 'DD-MON-YYYY'), TO_DATE('07-MAR-2003', 'DD-MON-YYYY'), 6);

INSERT INTO EMPLEADO1
VALUES(19, 19191919, 'Gabriel', 'Colón 11, Granada', 191919, 1500, TO_DATE('19-SEP-2000', 'DD-MON-YYYY'), TO_DATE('19-SEP-2000', 'DD-MON-YYYY'), 9);

INSERT INTO REGISTRO_EMPLEADOS
VALUES(1, 2, TO_DATE('21-SEP-1995', 'DD-MON-YYYY'), TO_DATE('21-SEP-2003', 'DD-MON-YYYY'));

INSERT INTO REGISTRO_EMPLEADOS
VALUES(1, 5, TO_DATE('21-SEP-2003', 'DD-MON-YYYY'), TO_DATE('14-OCT-2012', 'DD-MON-YYYY'));

INSERT INTO REGISTRO_EMPLEADOS
VALUES(2, 7, TO_DATE('25-AGO-1994', 'DD-MON-YYYY'), TO_DATE('13-SEP-2017', 'DD-MON-YYYY'));
    
INSERT INTO REGISTRO_EMPLEADOS
VALUES(3, 6, TO_DATE('30-ENE-1997', 'DD-MON-YYYY'), TO_DATE('20-DIC-2008', 'DD-MON-YYYY'));

INSERT INTO REGISTRO_EMPLEADOS
VALUES(4, 1, TO_DATE('13-FEB-1998', 'DD-MON-YYYY'), TO_DATE('23-ENE-2011', 'DD-MON-YYYY'));

INSERT INTO REGISTRO_EMPLEADOS
VALUES(5, 3, TO_DATE('01-OCT-2003', 'DD-MON-YYYY'), TO_DATE('28-FEB-2007', 'DD-MON-YYYY'));

INSERT INTO REGISTRO_EMPLEADOS
VALUES(5, 10, TO_DATE('1-MAR-2007', 'DD-MON-YYYY'), TO_DATE('13-JUN-2013', 'DD-MON-YYYY'));
    
INSERT INTO REGISTRO_EMPLEADOS
VALUES(6, 4, TO_DATE('1-ENE-1992', 'DD-MON-YYYY'), TO_DATE('20-ABR-2000', 'DD-MON-YYYY'));

INSERT INTO REGISTRO_EMPLEADOS
VALUES(6, 8, TO_DATE('21-ABR-2000', 'DD-MON-YYYY'), TO_DATE('7-DIC-2005', 'DD-MON-YYYY'));

INSERT INTO REGISTRO_EMPLEADOS
VALUES(6, 9, TO_DATE('8-DIC-2005', 'DD-MON-YYYY'), TO_DATE('16-MAR-2009', 'DD-MON-YYYY'));

INSERT INTO PROVEEDOR1 VALUES(3, 'Pescaveja', 'Granada'); 
INSERT INTO PROVEEDOR1 VALUES(4, 'Molinez', 'Granada');

INSERT INTO SUMINISTRA1 VALUES(14,3,5, TO_DATE('17-MAY-2022', 'DD-MON-YYYY'), 150, 20);
INSERT INTO SUMINISTRA1 VALUES(14,3,5, TO_DATE('15-JUN-2022', 'DD-MON-YYYY'), 100, 25);
INSERT INTO SUMINISTRA1 VALUES(4,3,6, TO_DATE('16-MAY-2022', 'DD-MON-YYYY'), 200, 15);
INSERT INTO SUMINISTRA1 VALUES(10,4,9, TO_DATE('13-MAY-2022', 'DD-MON-YYYY'), 200, 20);

INSERT INTO CLIENTE VALUES(1, 12345678, 'José', 123456); 
INSERT INTO CLIENTE VALUES(2, 89012345, 'Francisco', 890123);
INSERT INTO CLIENTE VALUES(3, 56789012, 'María', 567890);
INSERT INTO CLIENTE VALUES(4, 34567890, 'Cristina', 345678);
INSERT INTO CLIENTE VALUES(5, 01234567, 'Carmen', 012345);
INSERT INTO CLIENTE VALUES(6, 78901234, 'Juan', 789012);
INSERT INTO CLIENTE VALUES(7, 45678901, 'Miguel', 456789);
INSERT INTO CLIENTE VALUES(8, 23456789, 'Virtudes', 234567);
INSERT INTO CLIENTE VALUES(9, 22334455, 'Ignacio', 223344);
INSERT INTO CLIENTE VALUES(10, 66778899, 'Ismael', 667788);

INSERT INTO RESERVA1 VALUES(6,1, TO_DATE('20-JUL-2022', 'DD-MON-YYYY'), TO_DATE('31-JUL-2022', 'DD-MON-YYYY'), 'Doble', 150); 
INSERT INTO RESERVA1 VALUES(6,1, TO_DATE('05-NOV-2022', 'DD-MON-YYYY'), TO_DATE('12-NOV-2022', 'DD-MON-YYYY'), 'Doble', 100); 
INSERT INTO RESERVA1 VALUES(6,2, TO_DATE('20-JUL-2022', 'DD-MON-YYYY'), TO_DATE('31-JUL-2022', 'DD-MON-YYYY'), 'Doble', 150); 
INSERT INTO RESERVA1 VALUES(6,3, TO_DATE('20-JUL-2022', 'DD-MON-YYYY'), TO_DATE('31-JUL-2022', 'DD-MON-YYYY'), 'Doble', 150); 
INSERT INTO RESERVA1 VALUES(9,3, TO_DATE('01-JUN-2022', 'DD-MON-YYYY'), TO_DATE('09-JUN-2022', 'DD-MON-YYYY'), 'Sencilla', 90); 
INSERT INTO RESERVA1 VALUES(6,4, TO_DATE('20-JUL-2022', 'DD-MON-YYYY'), TO_DATE('31-JUL-2022', 'DD-MON-YYYY'), 'Doble', 150); 
INSERT INTO RESERVA1 VALUES(6,4, TO_DATE('30-NOV-2022', 'DD-MON-YYYY'), TO_DATE('30-NOV-2022', 'DD-MON-YYYY'), 'Doble', 100); 
INSERT INTO RESERVA1 VALUES(6,5, TO_DATE('20-JUL-2022', 'DD-MON-YYYY'), TO_DATE('31-JUL-2022', 'DD-MON-YYYY'), 'Doble', 150); 
INSERT INTO RESERVA1 VALUES(6,6, TO_DATE('20-JUL-2022', 'DD-MON-YYYY'), TO_DATE('31-JUL-2022', 'DD-MON-YYYY'), 'Doble', 150); 


INSERT INTO VENDE1 VALUES(1, 3);
INSERT INTO VENDE1 VALUES(2, 3);
INSERT INTO VENDE1 VALUES(3, 3); 
INSERT INTO VENDE1 VALUES(4, 3); 
INSERT INTO VENDE1 VALUES(5, 3); 
INSERT INTO VENDE1 VALUES(6, 4);
INSERT INTO VENDE1 VALUES(7, 4);
INSERT INTO VENDE1 VALUES(8, 4);
INSERT INTO VENDE1 VALUES(9, 4); 
INSERT INTO VENDE1 VALUES(10, 4);
INSERT INTO VENDE1 VALUES(11, 4);
INSERT INTO VENDE1 VALUES(12, 3); 
INSERT INTO VENDE1 VALUES(13, 3); 
INSERT INTO VENDE1 VALUES(14, 3); 
INSERT INTO VENDE1 VALUES(15, 3); 
